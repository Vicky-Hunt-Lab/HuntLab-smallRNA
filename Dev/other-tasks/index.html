
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://Vicky-Hunt-Lab.github.io/HuntLab-smallRNA/Dev/other-tasks/">
      
      
        <link rel="prev" href="../walkthrough/targetid/">
      
      
        <link rel="next" href="../cli-reference/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Other Tasks - Hunt Lab Small RNA Pipeline</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#other-tasks" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Hunt Lab Small RNA Pipeline" class="md-header__button md-logo" aria-label="Hunt Lab Small RNA Pipeline" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Hunt Lab Small RNA Pipeline
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Other Tasks
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Vicky-Hunt-Lab/HuntLab-smallRNA" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Vicky-Hunt-Lab/HuntLab-smallRNA
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../installation/" class="md-tabs__link">
        
  
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../walkthrough/" class="md-tabs__link">
          
  
  
  Walkthrough

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  Other Tasks

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../cli-reference/" class="md-tabs__link">
          
  
  
  CLI Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Hunt Lab Small RNA Pipeline" class="md-nav__button md-logo" aria-label="Hunt Lab Small RNA Pipeline" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Hunt Lab Small RNA Pipeline
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Vicky-Hunt-Lab/HuntLab-smallRNA" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Vicky-Hunt-Lab/HuntLab-smallRNA
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Walkthrough
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Walkthrough
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../walkthrough/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../walkthrough/prereq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prerequisites and Considerations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../walkthrough/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Config File
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../walkthrough/trim/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Trim
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../walkthrough/sort/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Sort
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../walkthrough/unitas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running Unitas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../walkthrough/targetid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running TargetID
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Other Tasks
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Other Tasks
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#plotting-genome-location" class="md-nav__link">
    <span class="md-ellipsis">
      Plotting Genome Location
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Plotting Genome Location">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-plot" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dealing-with-multiple-scaffolds" class="md-nav__link">
    <span class="md-ellipsis">
      Dealing with Multiple Scaffolds
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#signature-identification" class="md-nav__link">
    <span class="md-ellipsis">
      Signature Identification
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#atgc-richness" class="md-nav__link">
    <span class="md-ellipsis">
      AT/GC Richness
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#upstream-motif-eg-pirna" class="md-nav__link">
    <span class="md-ellipsis">
      Upstream motif (e.g. piRNA)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ping-pong-signature" class="md-nav__link">
    <span class="md-ellipsis">
      Ping Pong signature
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dicer-signature-steprna" class="md-nav__link">
    <span class="md-ellipsis">
      Dicer Signature (StepRNA)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#same-strand-overlap" class="md-nav__link">
    <span class="md-ellipsis">
      Same Strand Overlap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mirna" class="md-nav__link">
    <span class="md-ellipsis">
      miRNA
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    CLI Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            CLI Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli-reference/extractnc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ExtractNC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli-reference/label-for-unitas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Label for Unitas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli-reference/build-coord-files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Build Coord Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli-reference/overlapss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overlap SS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="other-tasks">Other Tasks</h1>
<p>This page covers some other bioinformatics tasks you may want to combine with the pipeline, using both programs included with and separate from the pipeline.</p>
<h2 id="plotting-genome-location">Plotting Genome Location</h2>
<h3 id="basic-plot">Basic Plot</h3>
<p>A common task you might want to do is plotting the location of things within the genome, for example, genome features you are interested in or the positions of small RNAs you have aligned to the genome. To make this easy, a script is included in this environment called <code>build_coord_files</code>. This automatically generates tsv files for use with the R package <code>chromPlot</code>. This section explains how you can generate a plot with it.</p>
<p>Firstly, you need at least two files: a full genome in a FASTA or FASTQ file and a set of locations you are interested in, either as an alignment output (in SAM or BAM format) or as feature annotations in GFF format. To start produce the genome coordinate file with the command: (assuming <code>genome.fasta</code> is your genome file)</p>
<div class="highlight"><pre><span></span><code>$ build_coord_files -o genome_coord.tsv genome.fasta 
</code></pre></div>
<p>By default, the script will figure out what type of output to produce by the file extension. But if it can’t, the user will need to provide a flag to tell it what type of input you are using (in this case <code>--fasta</code>). Next we produce the coordinates file for the item of interest, assuming it is in <code>alignment.sam</code> you can run:</p>
<div class="highlight"><pre><span></span><code>$ build_coord_files -o alignment_coord.tsv alignment.sam
</code></pre></div>
<p>This will produce two files, one for coordinates on the sense strand and one for coordinates on the antisense strand. Finally, we can use these files to plot the result. If it isn’t already, install chromPlot with bioconducter using the following R command:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">BiocManager</span><span class="o">::</span><span class="nf">install</span><span class="p">(</span><span class="s">&quot;chromPlot&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Then you should be able to create a plot using the following R code (of two example chromosomes called "SRAE_chr1" and "SRAE_chr2"):</p>
<div class="highlight"><pre><span></span><code><span class="n">chrom_coords</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;/path/to/genome_coord.tsv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;\t&quot;</span><span class="p">)</span>
<span class="n">sense_pos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;/path/to/sense_alignment_coord.tsv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;\t&quot;</span><span class="p">)</span>
<span class="n">antisense_pos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;/path/to/antisense_alignment_coord.tsv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;\t&quot;</span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">chromPlot</span><span class="p">)</span>

<span class="nf">chromPlot</span><span class="p">(</span>
<span class="w">  </span><span class="n">gaps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">chrom_coords</span><span class="p">,</span><span class="w"> </span><span class="n">annot1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sense_pos</span><span class="p">,</span><span class="w"> </span><span class="n">annot2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">antisense_pos</span><span class="p">,</span><span class="w"> </span><span class="n">plotRndchr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span>
<span class="w">  </span><span class="n">chr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;SRAE_chr1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SRAE_chr2&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">bin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50000</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">chrSide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<p>The script breaks down as follows:</p>
<ul>
<li>First three lines load in the data we just produced with <code>build_coord_files</code></li>
<li>Following line loads the chromPlot library into R</li>
<li>The final line plots the data with chromPlot:</li>
<li><code>gaps</code> defines what each chromosome should look like</li>
<li><code>annot1</code> and <code>annot2</code> define the annotation data to show</li>
<li><code>plotRndchr</code> disables the assumption in chromPlot that the chromosomes are labelled with numbers</li>
<li><code>chr</code> selects which chromosomes to plot by specifying an array of names</li>
<li><code>bin</code> sets the bin size to group the features into when plotting</li>
<li><code>chrSide</code> defines which side of the chromosome to plot each feature, the only change we have made from the default is setting the second item to <code>1</code> as opposed to <code>-1</code>. This ensures <code>annot2</code> is plotted on the opposite side to <code>annot1</code></li>
</ul>
<p>The resulting plot will look something like this:</p>
<p><img alt="A plot of locations of small RNA on two chromosomes labelled SRAE_chr1 and SRAE_chr2" src="../images/chromplot1.jpg" title="Chromplot location output" /></p>
<h3 id="dealing-with-multiple-scaffolds">Dealing with Multiple Scaffolds</h3>
<p>In more complex cases, one or more of your chromosomes may be split into multiple scaffolds. <code>build_coord_files</code> has a scaffold aware mode that can automatically try to merge these, but it will only work if your scaffold’s IDs are in the form of <code>&lt;chromosome_name&gt;_scaffold&lt;scaffold_number&gt;</code> e.g. <code>SRAE_chrX_scaffold1</code>. Once you have this, you can generate the data files with the <code>-c</code> flag set, as follows:</p>
<div class="highlight"><pre><span></span><code>$ build_coord_files -c -o genome_coord.tsv genome.fasta 
$ build_coord_files -c --genome-coords genome_coord.tsv -o alignment_coord.tsv alignment.sam
</code></pre></div>
<p>Note you need to provide the genome coords file when generating files for what you are plotting, this allows for a correction of coordinates to be made from where scaffolds are merged. In addition to the regular files, this produces <code>scaffold_info_genome_coord.tsv</code>, that can be used to add scaffold dividers to your plots. To do this, the following R script can be run:</p>
<div class="highlight"><pre><span></span><code><span class="n">chrom_coords</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;/path/to/genome_coord.tsv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;\t&quot;</span><span class="p">)</span>
<span class="n">sense_pos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;/path/to/sense_alignment_coord.tsv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;\t&quot;</span><span class="p">)</span>
<span class="n">antisense_pos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;/path/to/antisense_alignment_coord.tsv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;\t&quot;</span><span class="p">)</span>
<span class="n">scaffolds</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;/path/to/scaffold_info_genome_coord.tsv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;\t&quot;</span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">chromPlot</span><span class="p">)</span>

<span class="nf">chromPlot</span><span class="p">(</span>
<span class="w">  </span><span class="n">gaps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">chrom_coords</span><span class="p">,</span><span class="w"> </span><span class="n">annot1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sense_pos</span><span class="p">,</span><span class="w"> </span><span class="n">annot2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">antisense_pos</span><span class="p">,</span><span class="w"> </span><span class="n">plotRndchr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span>
<span class="w">  </span><span class="n">chr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;SRAE_chr1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;SRAE_chr2&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">bin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50000</span><span class="p">,</span><span class="w"> </span><span class="n">bands</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scaffolds</span><span class="p">,</span>
<span class="w">  </span><span class="n">chrSide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<p>Compared to the last script, this adds:</p>
<ul>
<li>The fourth line, that loads in the scaffold data</li>
<li>The bands argument, that draws red lines at the end of each scaffold</li>
</ul>
<p>Note that, by default the bands are 20,000 bp wide, as that looks good on the plot. At that size they may not appear if you make the bins too much bigger. Therefore, if you plan to make the bins bigger, pass a larger value to the <code>--band-width</code> flag when creating the genome file. That makes the bands bigger, which results in a more visible line on the plot.</p>
<p>A plot produced by this method will look something like:</p>
<p><img alt="A plot of locations of small RNA on one chromosomes labelled SRAE_chrX" src="../images/chromplot2.jpg" title="Chromplot location output for X" />
 </p>
<h2 id="signature-identification">Signature Identification</h2>
<p>TODO</p>
<h2 id="atgc-richness">AT/GC Richness</h2>
<p>Nucleotide richness and the presence of any conserved motifs is identified using <a href="https://weblogo.threeplusone.com">WebLogo</a>. Sequences need to be the same length and can be either uploaded using a fasta file or can be pasted in.</p>
<h2 id="upstream-motif-eg-pirna">Upstream motif (e.g. piRNA)</h2>
<ol>
<li>Map to genome with bowtie2, convert sam to bam with <code>samtools</code>, convert bamToBed with <code>bedtools</code> </li>
</ol>
<div class="highlight"><pre><span></span><code>$ bowtie2 -x genome.fasta -f -U sequences.fasta -S sequences_mapped.sam
$ samtools view sequences_mapped.sam -o sequences_mapped.bam
$ bamToBed -i sequences.bam &gt; sequences.bed
</code></pre></div>
<ol>
<li>Extract flanking sequences with flankBed in <code>bedtools</code> (need to use bedtools format genome file - generate with faidx and cut):</li>
</ol>
<div class="highlight"><pre><span></span><code>$ samtools faidx genome.fasta  
$ cut -f 1,2 genome.fa.fai &gt; chrom.sizes
$ flankBed -i sequences.bed -g chrom.sizes -b 100 &gt; sequences_100nt_flank.bed
</code></pre></div>
<p>or for 60 upstream only:</p>
<div class="highlight"><pre><span></span><code>$ flankBed -i sequences.bed -g chrom.sizes -l 60 -r 0 &gt; sequnences_60nt.bed
</code></pre></div>
<ol>
<li>Extract fasta sequences from bed fastFromBed with bedtools.</li>
</ol>
<div class="highlight"><pre><span></span><code>$ fastaFromBed -fi genome.fasta -bed sequences_100nt_Flank.bed -fo sequences_100nt_Flank_seqs.fasta
</code></pre></div>
<h2 id="ping-pong-signature">Ping Pong signature</h2>
<p>To find ping-pong signature, Unitas with the option -pp can be used to find 5’ overlaps of mapped sequence reads to the genome and calculate a Z-score for the enrichment of 10 bp overlaps. <code>map.file</code> should be in SAM or ELAND3 format.</p>
<div class="highlight"><pre><span></span><code>$ perl unitas.pl -pp -input map.file  –species x –refseq reference.fasta
</code></pre></div>
<h2 id="dicer-signature-steprna">Dicer Signature (StepRNA)</h2>
<p>To install stepRNA, see the documentation on <a href="https://github.com/Vicky-Hunt-Lab/stepRNA">the GitHub page</a>.</p>
<p>stepRNA is able to identify a Dicer processing signature from a small RNA sequence dataset. It requires two FASTA files as input that have had their adapters already trimmed from the ends.</p>
<div class="highlight"><pre><span></span><code>$ stepRNA --reference REFERENCE.fa --reads READS.fa
</code></pre></div>
<ul>
<li>READS.fa should contain all of the small RNA sequencing reads.</li>
<li>REFERENCE.fa is usually filtered to investigate small RNAs of interest e.g. 26G sRNAs.</li>
</ul>
<p>Identical reads in the READ and REFERENCE files can also be removed before searching for a Dicer signature, if desired, by using <code>-e/--remove_exact</code>. </p>
<p>Importantly the FASTA headers must be unique - this can be done by stepRNA with <code>-u/--make_unique</code>.</p>
<p>stepRNA will then generate: </p>
<ul>
<li>BAM alignment files (with different combinations of overhang lengths)</li>
<li>Overhang length CSV</li>
<li>Passenger Read Length CSV</li>
</ul>
<p>These can then be used to plot the distribution and/or further explore the reads that have aligned. </p>
<p>Note: If the sRNA lengths in the read file are all the same i.e. 21 nt long, stepRNA will not be able to find overhangs due to the scoring system. In this case the <code>-m/--min_score</code> should be set to an appropriate value; we recommend sRNA length - 7nt (e.g. 21 - 6 = 15).</p>
<p>Use <code>stepRNA --help</code> to bring up the command line help, a description of the methods can be found in the <a href="https://www.frontiersin.org/journals/bioinformatics/articles/10.3389/fbinf.2022.994871/full">stepRNA publication</a>.</p>
<div class="highlight"><pre><span></span><code>stepRNA [-h] -r REFERENCE -q READS [-n NAME] [-d DIRECTORY]
               [-m MIN_SCORE] [-e] [-u] [-j] [-V]

Align a reference RNA file to read sequences. Output will be a set of CSV files containing information about the length of the reads, number of reads aligned to a reference sequence and the length of overhangs of the alignment.
Reference RNA file will be automatically indexed

Optional Arguments:
  -h, --help            show this help message and exit
  -n NAME, --name NAME  Prefix for the output files
  -d DIRECTORY, --directory DIRECTORY
                        Directory to store the output files
  -m MIN_SCORE, --min_score MIN_SCORE
                        Minimum score to accept, default is the shortest read
                        length

Required Arguments:
  -r REFERENCE, --reference REFERENCE
                        Path to the reference sequences
  -q READS, --reads READS
                        Path to the read sequences

Flags:
  -e, --remove_exact    Remove exact read matches to the reference sequence
  -u, --make_unique     Make FASTA headers unique in reference and reads i.e.
                        &gt;Read_1 &gt;Read_2
  -j, --write_json      Write count dictionaries to a JSON file
  -V, --version         Print version number then exit.
</code></pre></div>
<h2 id="same-strand-overlap">Same Strand Overlap</h2>
<p>If you wish to detect same strand overlaps, you can use the <code>overlap_ss</code> script that is installed in the same environment as this pipeline. This uses a number of bash programs to create files that show where two sets of small RNA that appear on the same strand overlap.</p>
<p>To use this script you need two sets of small RNA as FASTA or FASTQ files, one for the base and one for the overlap, plus the genome of the species of interest. You can then run the script in the following way:</p>
<div class="highlight"><pre><span></span><code>$ overlap_ss genome.fasta smallRNA1.fastq smallRNA2.fastq
</code></pre></div>
<p>This script will then create output in the output directory specified in <code>config.toml</code> under the directory <code>samestrand_overlap/</code>.</p>
<h2 id="mirna">miRNA</h2>
<p>TODO</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../walkthrough/targetid/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Running TargetID">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Running TargetID
              </div>
            </div>
          </a>
        
        
          
          <a href="../cli-reference/" class="md-footer__link md-footer__link--next" aria-label="Next: Overview">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Overview
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2021 - 2025 Kieran Reynolds & Vicky Hunt Lab Members
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.path", "navigation.footer", "navigation.tabs", "navigation.tabs.sticky", "toc.follow", "toc.integrate", "content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>